use ass1;
CREATE TABLE EMPLOYEE( 
EMP_CODE varchar(16) NOT NULL PRIMARY KEY, 
EMP_NAME varchar(20), 
DEPT_CODE varchar(16), 
DESIG_CODE varchar(16), 
SEX varchar(1), 
ADDRESS varchar(25), 
CITY varchar(20), 
STATE varchar(20), 
PIN varchar(6), 
BASIC int, 
JN_DT Date);

 CREATE TABLE DESIGNATION( 
DESIG_CODE varchar(16) NOT NULL PRIMARY KEY, 
DESIG_DESC varchar(20));

CREATE TABLE DEPARTMENT( 
DEPT_CODE varchar(16) NOT NULL PRIMARY KEY, 
DEPT_NAME varchar(20)); 

 DESC EMPLOYEE; 
 DESC DESIGNATION; 
 DESC DEPARTMENT;
 
INSERT INTO DEPARTMENT(DEPT_CODE, DEPT_NAME) VALUES('PER','Personnel'); 
INSERT INTO DEPARTMENT(DEPT_CODE, DEPT_NAME) VALUES('PR','Production'); 
INSERT INTO DEPARTMENT(DEPT_CODE, DEPT_NAME) VALUES('PUR','Purchase'); 
INSERT INTO DEPARTMENT(DEPT_CODE, DEPT_NAME) VALUES('FI','Finance');
INSERT INTO DEPARTMENT(DEPT_CODE, DEPT_NAME) VALUES('RE','Research'); 
INSERT INTO DEPARTMENT(DEPT_CODE, DEPT_NAME) VALUES('MR','MARKETTING'); 

SELECT * FROM DEPARTMENT;

INSERT INTO DESIGNATION(DESIG_CODE, DESIG_DESC) VALUES('MN','Manager'); 
INSERT INTO DESIGNATION(DESIG_CODE, DESIG_DESC) VALUES('EXE','Executive'); 
INSERT INTO DESIGNATION(DESIG_CODE, DESIG_DESC) VALUES('OFF','Officer'); 
INSERT INTO DESIGNATION(DESIG_CODE, DESIG_DESC) VALUES('CL','Clerk'); 
INSERT INTO DESIGNATION(DESIG_CODE, DESIG_DESC) VALUES('HL','Helper'); 
SELECT * FROM DESIGNATION;

SELECT * FROM EMPLOYEE;

INSERT INTO EMPLOYEE(EMP_CODE, EMP_NAME, DEPT_CODE, DESIG_CODE, SEX, ADDRESS, CITY, STATE, PIN, BASIC, JN_DT) VALUES 
('E101','Shruti Pathak','PR','EXE','F','Purulia','Purulia','West Bengal','723102',45000,DATE '2015-05-01');
INSERT INTO EMPLOYEE(EMP_CODE, EMP_NAME, DEPT_CODE, DESIG_CODE, SEX, ADDRESS, CITY, STATE, PIN, BASIC, JN_DT) VALUES 
('E102','Annesa Mondal','FI','OFF','F','Krishnagar','Nadia','West Bengal','741101',50000,DATE '2020-01-02'); 
INSERT INTO EMPLOYEE(EMP_CODE, EMP_NAME, DEPT_CODE, DESIG_CODE, SEX, ADDRESS, CITY, STATE, PIN, BASIC, JN_DT) VALUES 
('E103','Rahul Mahato','PUR','MN','M','Haldia','EastMidnapur','West Bengal','721108',60000,DATE '2020-05-01'); 
INSERT INTO EMPLOYEE(EMP_CODE, EMP_NAME, DEPT_CODE, DESIG_CODE, SEX, ADDRESS, CITY, STATE, PIN, BASIC, JN_DT) VALUES 
('E104','Nilesh Kundu','RE','HL','M','Durgapur','West Burdwan','West Bengal','700014',90000,DATE '2018-02-01'); 
INSERT INTO EMPLOYEE(EMP_CODE, EMP_NAME, DEPT_CODE, DESIG_CODE, SEX, ADDRESS, CITY, STATE, PIN, BASIC, JN_DT) VALUES 
('E105','Nitish Kumar Mondal','FI','CL','M','New Town','Kolkata','West Bengal','700026',25000,DATE '2022-01-02'); 
INSERT INTO EMPLOYEE(EMP_CODE, EMP_NAME, DEPT_CODE, DESIG_CODE, SEX, ADDRESS, CITY, STATE, PIN, BASIC, JN_DT) VALUES 
('E106','Himangsu Bauri','PUR','EXE','M','Thakurpukur','Kolkata','West Bengal','400020',40000,DATE '2021-08-01'); 
INSERT INTO EMPLOYEE(EMP_CODE, EMP_NAME, DEPT_CODE, DESIG_CODE, SEX, ADDRESS, CITY, STATE, PIN, BASIC, JN_DT) VALUES 
('E107','Ivy Dey','PR','MN','F','Garia','Kolkata','West Bengal','700009',60000,DATE '2016-02-01'); 
INSERT INTO EMPLOYEE(EMP_CODE, EMP_NAME, DEPT_CODE, DESIG_CODE, SEX, ADDRESS, CITY, STATE, PIN, BASIC, JN_DT) VALUES 
('E108','Saraswati Murmu','PER','OFF','F','Jadavpur','Kolkata','West Bengal','760038',55000,DATE '2020-08-01'); 
INSERT INTO EMPLOYEE(EMP_CODE, EMP_NAME, DEPT_CODE, DESIG_CODE, SEX, ADDRESS, CITY, STATE, PIN, BASIC, JN_DT) VALUES 
('E109','Anjani Ahir','FI','CL','F','Naihati','North 24 Parbanas','West Bengal','710001',25000,DATE '2010-03-01'); 
INSERT INTO EMPLOYEE(EMP_CODE, EMP_NAME, DEPT_CODE, DESIG_CODE, SEX, ADDRESS, CITY, STATE, PIN, BASIC, JN_DT) VALUES 
('E110','Ankita Dutta','RE','EXE','F','Bankura','Bankura','West Bengal','700034',200000,DATE '2021-11-12'); 
INSERT INTO EMPLOYEE(EMP_CODE, EMP_NAME, DEPT_CODE, DESIG_CODE, SEX, ADDRESS, CITY, STATE, PIN, BASIC, JN_DT) VALUES 
('E111','Priyanka Ghosh',NULL,'EXE','F','Dumdum','Kolkata','West Bengal','700034',NULL,DATE '2021-11-12');
INSERT INTO EMPLOYEE(EMP_CODE, EMP_NAME, DEPT_CODE, DESIG_CODE, SEX, ADDRESS, CITY, STATE, PIN, BASIC, JN_DT) VALUES 
('E112','Robiul Islam',NULL,'HL','M','Durgapur','West Burdwan','West Bengal','700014',NULL,DATE '2022-01-03'); 
INSERT INTO EMPLOYEE(EMP_CODE, EMP_NAME, DEPT_CODE, DESIG_CODE, SEX, ADDRESS, CITY, STATE, PIN, BASIC, JN_DT) VALUES 
('E113','Priti Mondal',NULL,'OFF','F','Krishnagar','Nadia','West Bengal','741101',0,DATE '2022-06-02'); 
INSERT INTO EMPLOYEE(EMP_CODE, EMP_NAME, DEPT_CODE, DESIG_CODE, SEX, ADDRESS, CITY, STATE, PIN, BASIC, JN_DT) VALUES 
('E114','Rahul Lugun',NULL,'CL','M','New Town','Kolkata','West Bengal','700026',0,DATE '2022-01-02'); 
-- 1 row(s) affected

SELECT * FROM EMPLOYEE;
-- 14 row(s) returned

SELECT * FROM EMPLOYEE WHERE DEPT_CODE IS NULL;
-- 4 row(s) returned

SELECT * FROM EMPLOYEE WHERE BASIC = 0; 
-- 2 row(s) returned

 SELECT * FROM EMPLOYEE WHERE BASIC IS NULL; 
-- 2 row(s) returned
 
 SELECT AVG(BASIC) FROM EMPLOYEE; 
 -- 1 row(s) returned

 UPDATE EMPLOYEE SET BASIC = 0  WHERE BASIC IS NULL;
 -- 2 row(s) affected Rows matched: 2  Changed: 2  Warnings: 0

 SELECT AVG(BASIC) FROM EMPLOYEE;
 -- 1 row(s) returned

 DELETE FROM EMPLOYEE WHERE DEPT_CODE IS NULL;
 -- 4 row(s) affected


 SELECT EMP_NAME, BASIC * 0.4 + BASIC * 0.5 AS NET_PAY FROM EMPLOYEE;
 -- 10 row(s) returned

  SELECT UPPER(EMP_NAME), BASIC FROM EMPLOYEE ORDER BY BASIC;
  -- 10 row(s) returned

  SELECT EMP_NAME AS EMPLOYEE_NAME, JN_DT AS JOIN_DATE FROM EMPLOYEE WHERE JN_DT > '2020-01-01';
  -- 6 row(s) returned

SELECT COUNT(*) FROM EMPLOYEE WHERE SUBSTR(JN_DT,6,2) = '01'; 
 -- 1 row(s) returned
  
SELECT MAX(BASIC), MIN(BASIC) FROM EMPLOYEE;
-- 1 row(s) returned

SELECT COUNT(*) FROM EMPLOYEE WHERE SEX = 'F'; 
-- 1 row(s) returned

UPDATE EMPLOYEE SET CITY = UPPER(CITY); 
-- 10 row(s) affected Rows matched: 10  Changed: 10  Warnings: 0

 SELECT CITY FROM EMPLOYEE; 
 -- 10 row(s) returned

SELECT CITY, COUNT(*) FROM EMPLOYEE GROUP BY CITY; 
-- 7 row(s) returned

SELECT * FROM EMPLOYEE ORDER BY DEPT_CODE, BASIC DESC;
-- 10 row(s) returned
